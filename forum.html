<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Darwin Life Hub · Forum</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- 分享卡片（WeChat / QQ / 朋友圈等用来显示标题和描述） -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Darwin Life Hub · 达尔文本地交流论坛">
  <meta property="og:description" content="达尔文华人、本地留学生的交流论坛，分享打工、租房、生活经验与问题讨论。">
  <meta property="og:image" content="https://darwinbbs.com/darwin-logo.png">
  <meta property="og:url" content="https://darwinbbs.com/forum.html">

  <!-- 备用描述（部分国内 App 使用） -->
  <meta name="description" content="达尔文本地论坛，提供打工经验、租房信息、生活问答等交流平台。">

<style>
    :root {
      --bg:#f5f9f5;
      --bg-card:#ffffff;
      --primary:#16a34a;
      --text-main:#0f172a;
      --text-muted:#6b7280;
      --border:#d1e5d4;
      --max-width:1040px;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:var(--bg);
      color:var(--text-main);
    }
    a{color:inherit;text-decoration:none;}

    /* 顶部导航 */
    .top-nav{
      width:100%;
      background:#e8f5ec;
      padding:10px 0;
      border-bottom:1px solid #cfe8d8;
      position:sticky;
      top:0;
      z-index:30;
      box-shadow:0 2px 4px rgba(15,23,42,0.06);
    }
    .nav-inner{
      max-width:1100px;
      margin:0 auto;
      padding:0 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .brand-logo{
      width:48px;
      height:48px;
      border-radius:50%;
      overflow:hidden;
      background:#ffffff;
      box-shadow:0 4px 14px rgba(0,0,0,0.15);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .brand-logo img{ width:100%; height:100%; object-fit:cover; }
    .brand-text-main{ font-size:18px; font-weight:600; color:#022c22; }
    .brand-text-sub{ font-size:13px; color:var(--text-muted); margin-top:-2px; }

    nav.nav-links{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      font-size:15px;
    }
    nav.nav-links a{
      padding:6px 12px;
      border-radius:6px;
      color:#0f172a;
      text-decoration:none;
      transition:0.15s ease;
    }
    nav.nav-links a:hover{background:#d9fbe5;}
    nav.nav-links a.active{background:#16a34a;color:#f0fdf4;}

    .shell{max-width:var(--max-width);margin:0 auto;padding:24px 16px 60px;}
    .page-title{font-size:22px;font-weight:700;margin-bottom:8px;}
    .page-subtitle{font-size:13px;color:var(--text-muted);margin-bottom:18px;}

    .layout{
      display:grid;
      grid-template-columns:minmax(0,1.4fr);
      gap:18px;
    }
    .card{
      background:var(--bg-card);
      border-radius:18px;
      border:1px solid var(--border);
      padding:18px 18px 20px;
      box-shadow:0 18px 40px rgba(15,23,42,0.06);
    }
    .section-title{font-size:16px;font-weight:600;margin-bottom:12px;}

    label{display:block;font-size:13px;margin-bottom:4px;color:var(--text-muted);}
    input,textarea{
      width:100%;
      font-family:inherit;
      font-size:14px;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      margin-bottom:10px;
    }
    textarea{min-height:120px;resize:vertical;}

    button{
      border:none;
      border-radius:999px;
      padding:8px 20px;
      font-size:14px;
      cursor:pointer;
      background:var(--primary);
      color:#ffffff;
    }
    button:hover{background:#15803d;}

    .posts-empty{font-size:13px;color:var(--text-muted);}
    .post-card{
      margin-bottom:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#ffffff;
      box-shadow:0 6px 16px rgba(15,23,42,0.06);
      font-size:14px;
    }
    .post-card h3{font-size:15px;margin-bottom:4px;}

    .fab{
      position:fixed; right:18px; bottom:18px;
      width:44px; height:44px;
      border-radius:50%;
      background:var(--primary);
      color:#ffffff;
      font-size:26px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
      box-shadow:0 10px 24px rgba(15,23,42,0.6);
    }

    /* === 新增：可删除图片预览样式 === */
    .preview-item{
      position:relative;
      display:inline-block;
    }
    .preview-remove{
      position:absolute;
      top:2px;
      right:2px;
      width:18px;
      height:18px;
      border:none;
      border-radius:50%;
      background:rgba(0,0,0,0.6);
      color:#fff;
      font-size:12px;
      line-height:18px;
      cursor:pointer;
    }
    .preview-remove:hover{background:rgba(0,0,0,0.8);}
    .clear-images-btn{
      margin-top:4px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid #d1e5d4;
      background:#f9fafb;
      font-size:12px;
      cursor:pointer;
      align-self:flex-start;
      color:red;
    }
    .clear-images-btn:hover{background:#e5f3ea;}

    .forum-photos{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .forum-photos img{
      width:90px;
      height:90px;
      object-fit:cover;
      border-radius:8px;
      border:1px solid var(--border);
    }
</style>
</head>
<body>

<header class="top-nav">
  <div class="nav-inner">
    <div class="brand">
      <div class="brand-logo">
        <img src="darwin-logo.png" />
      </div>
      <div>
        <div class="brand-text-main">Darwin Life Hub</div>
        <div class="brand-text-sub">达尔文华人生活门户 · Forum</div>
      </div>
    </div>

    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="news.html">News</a>
      <a href="jobs.html">Jobs</a>
      <a href="cv.html">CV</a>
      <a href="rent.html">Rent</a>
      <a href="forum.html" class="active">Forum</a>
      <a href="my.html">My</a>
      <a href="about.html">About</a>
    </nav>
  </div>
</header>

<div class="shell">
  <main>

    <div class="page-title">论坛·Forum</div>
    <div class="page-subtitle">提出问题、分享经验、闲聊都可以</div>

    <div class="layout">

      <section class="card">
        <div class="section-title">所有帖子</div>
        <div id="posts" class="posts-empty">暂时还没有帖子</div>
      </section>

      <section class="card" id="forumFormSection">
        <div class="section-title">发布帖子</div>

        <form id="forumForm">
          <label for="title">标题</label>
          <input id="title" type="text" />

          <label for="content">内容</label>
          <textarea id="content"></textarea>

          <div class="image-group">
            <label for="forumImages">配图（最多 5 张）</label>
            <input id="forumImages" type="file" multiple />
          </div>

          <div id="forumPreview" class="forum-photos"></div>
          <button type="button" id="forumClearImages" class="clear-images-btn">清空图片</button>

          <button type="submit">发布</button>
          <div id="forumStatus" style="font-size:13px;margin-top:6px;"></div>
        </form>
      </section>

    </div>
  </main>
</div>

<button class="fab" id="fabForum">+</button>

<script>
document.getElementById("fabForum").addEventListener("click", () => {
  document.getElementById("forumFormSection")
    .scrollIntoView({ behavior: "smooth" });
});
</script>
<!-- Supabase UMD 和你的客户端配置 -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="supabase.js"></script>
<script src="auth-guard.js"></script>
<script src="forum.js"></script>

</body>
</html>
